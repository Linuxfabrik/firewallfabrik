name: 'Test: basic accept/deny'
libraries:
  - name: 'Test Objects'
    children:
      - type: 'ICMPService'
        name: 'echo request'
        codes:
          type: 8
          code: 0
      - type: 'IPv4'
        name: 'external-host'
        inet_addr_mask:
          address: '203.0.113.42'
          netmask: '255.255.255.255'
      - type: 'Firewall'
        name: 'fw-test'
        data:
          platform: 'iptables'
          host_OS: 'linux24'
          version: ''
        options:
          accept_established: true
          configure_interfaces: false
          load_modules: false
          manage_virtual_addr: false
          verify_interfaces: false
        interfaces:
          - name: 'eth0'
            data:
              label: 'outside'
            addresses:
              - type: 'IPv4'
                name: 'eth0-addr'
                inet_addr_mask:
                  address: '203.0.113.1'
                  netmask: '255.255.255.0'
          - name: 'eth1'
            data:
              label: 'inside'
            addresses:
              - type: 'IPv4'
                name: 'eth1-addr'
                inet_addr_mask:
                  address: '192.168.1.1'
                  netmask: '255.255.255.0'
          - name: 'lo'
            addresses:
              - type: 'IPv4'
                name: 'lo-addr'
                inet_addr_mask:
                  address: '127.0.0.1'
                  netmask: '255.0.0.0'
        rule_sets:
          - type: 'Policy'
            name: 'Policy'
            ipv4: true
            top: true
            rules:
              - type: 'PolicyRule'
                action: 'Accept'
                direction: 'Inbound'
                dst:
                  - 'Library:Test Objects/Firewall:fw-test/Interface:eth0/IPv4:eth0-addr'
                  - 'Library:Test Objects/Firewall:fw-test/Interface:eth1/IPv4:eth1-addr'
                src:
                  - 'Library:Test Objects/Network:internal-net'
                srv:
                  - 'Library:Test Objects/TCPService:ssh'
              - type: 'PolicyRule'
                position: 1
                action: 'Accept'
                direction: 'Inbound'
                dst:
                  - 'Library:Test Objects/Firewall:fw-test/Interface:eth0/IPv4:eth0-addr'
                  - 'Library:Test Objects/Firewall:fw-test/Interface:eth1/IPv4:eth1-addr'
                srv:
                  - 'Library:Test Objects/ICMPService:echo request'
              - type: 'PolicyRule'
                position: 2
                action: 'Deny'
                direction: 'Inbound'
              - type: 'PolicyRule'
                position: 3
                action: 'Accept'
                direction: 'Both'
                dst:
                  - 'Library:Test Objects/IPv4:external-host'
                src:
                  - 'Library:Test Objects/Network:internal-net'
      - type: 'Network'
        name: 'internal-net'
        inet_addr_mask:
          address: '192.168.1.0'
          netmask: '255.255.255.0'
      - type: 'TCPService'
        name: 'ssh'
        dst_range_start: 22
        dst_range_end: 22
